---
import Layout from "@/layouts/Layout.astro";
import HeaderPage from "@/sections/HeaderPage.astro";
import FiltersPersonage from "@/components/FiltersPersonage.astro";
import Personages from "@/sections/Personages.astro";
import Pagination from "@/components/Pagination.astro";
import { getNumberPagination } from "@/services/getNumberPagination";
// import PersonagesWithPagination from "@/components/react/PersonagesWithPagination";

// Obtener el número de página desde la URL
const currentPage = parseInt(Astro.url.searchParams.get("page") || "1");

const numberPagination = await getNumberPagination();

const structuredData = {
	"@context": "https://schema.org",
	"@type": "WebSite",
	name: "Proyecto JS API Rick y Morty",
	description:
		"Explora el universo de Rick y Morty: personajes, episodios y localizaciones con nuestra aplicación web interactiva.",
	url: Astro.site?.href,
	inLanguage: "es",
	author: {
		"@type": "Person",
		name: "Esteban Dev",
	},
	potentialAction: {
		"@type": "SearchAction",
		target: {
			"@type": "EntryPoint",
			urlTemplate: `${Astro.site?.href}?search={search_term_string}`,
		},
		"query-input": "required name=search_term_string",
	},
};
---

<Layout
	title="Proyecto JS API Rick y Morty | Explora Personajes, Episodios y Más"
	description="Descubre el universo completo de Rick y Morty: explora personajes, episodios y localizaciones. Aplicación web interactiva con filtros avanzados y búsqueda en tiempo real."
	keywords="Rick y Morty, personajes Rick y Morty, episodios Rick y Morty, API Rick y Morty, Astro, JavaScript, Esteban Dev, buscador personajes"
	type="website"
>
	<script
		type="application/ld+json"
		set:html={JSON.stringify(structuredData)}
	/>

	<HeaderPage />
	<FiltersPersonage />
	<Personages />
	<Pagination totalPages={numberPagination} currentPage={currentPage} />
</Layout>
